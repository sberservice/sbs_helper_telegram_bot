"""
messages.py ‚Äî —Å–æ–æ–±—â–µ–Ω–∏—è –º–æ–¥—É–ª—è AI-–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏.

–°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–æ–¥—É–ª–µ–º AI-–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏.
–í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è MarkdownV2.
"""

import re


def escape_markdown_v2(text: str) -> str:
    """
    –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –¥–ª—è Telegram MarkdownV2.

    Args:
        text: –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.

    Returns:
        –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç.
    """
    special_chars = r"_*[]()~`>#+-=|{}.!"
    return re.sub(f"([{re.escape(special_chars)}])", r"\\\1", text)


# =============================================
# –°–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
# =============================================

MESSAGE_AI_PROCESSING = "‚è≥ _–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –≤–∞—à –∑–∞–ø—Ä–æ—Å\\.\\.\\._"

MESSAGE_AI_RATE_LIMITED = (
    "‚ö†Ô∏è *–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤*\n\n"
    "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ {seconds} —Å–µ–∫\\. –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –∑–∞–ø—Ä–æ—Å–æ–º\\.\n"
    "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ—É–Ω–∫—Ü–∏—è–º\\."
)

MESSAGE_AI_UNAVAILABLE = (
    "‚ö†Ô∏è *AI\\-–ø–æ–º–æ—â–Ω–∏–∫ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω*\n\n"
    "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ —Ñ—É–Ω–∫—Ü–∏—è–º –±–æ—Ç–∞\\."
)

MESSAGE_AI_ERROR = (
    "‚ùå *–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞*\n\n"
    "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é\\."
)

MESSAGE_AI_MODULE_DISABLED = (
    "‚ö†Ô∏è *–ú–æ–¥—É–ª—å ¬´{module_name}¬ª –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á—ë–Ω*\n\n"
    "–û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –∏–ª–∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –∑–∞–ø—Ä–æ—Å\\."
)

MESSAGE_AI_LOW_CONFIDENCE = (
    "ü§î –Ø –Ω–µ —Å–æ–≤—Å–µ–º —É–≤–µ—Ä–µ–Ω, —á—Ç–æ –≤—ã –∏–º–µ–µ—Ç–µ –≤ –≤–∏–¥—É\\.\n"
    "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ—Ñ—Ä–∞–∑–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é\\."
)

MESSAGE_MODULE_DISABLED_BUTTON = (
    "‚ö†Ô∏è *–ú–æ–¥—É–ª—å –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á—ë–Ω*\n\n"
    "–≠—Ç–æ—Ç –º–æ–¥—É–ª—å –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º\\. "
    "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é\\."
)

# =============================================
# –°–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è chat-–æ—Ç–≤–µ—Ç–æ–≤
# =============================================

MESSAGE_AI_CHAT_PREFIX = "ü§ñ "

# =============================================
# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
# =============================================


def format_rate_limit_message(seconds_remaining: int) -> str:
    """
    –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–∏ —á–∞—Å—Ç–æ—Ç—ã.

    Args:
        seconds_remaining: –û—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö.

    Returns:
        –ì–æ—Ç–æ–≤–æ–µ MarkdownV2 —Å–æ–æ–±—â–µ–Ω–∏–µ.
    """
    return MESSAGE_AI_RATE_LIMITED.format(seconds=str(seconds_remaining))


def format_ai_chat_response(text: str) -> str:
    """
    –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–π –æ—Ç–≤–µ—Ç AI –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram.

    Args:
        text: –¢–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ –æ—Ç LLM.

    Returns:
        –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è MarkdownV2 —Ç–µ–∫—Å—Ç —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º.
    """
    escaped = escape_markdown_v2(text)
    return f"{MESSAGE_AI_CHAT_PREFIX}{escaped}"


def format_module_disabled_message(module_name: str) -> str:
    """
    –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç–∫–ª—é—á—ë–Ω–Ω–æ–º –º–æ–¥—É–ª–µ.

    Args:
        module_name: –ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è.

    Returns:
        MarkdownV2-—Å–æ–æ–±—â–µ–Ω–∏–µ.
    """
    escaped_name = escape_markdown_v2(module_name)
    return MESSAGE_AI_MODULE_DISABLED.format(module_name=escaped_name)
