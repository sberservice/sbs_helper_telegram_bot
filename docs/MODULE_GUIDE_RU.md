# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –º–æ–¥—É–ª–µ–π

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–±—ä—è—Å–Ω—è–µ—Ç, –∫–∞–∫ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –º–æ–¥—É–ª–∏ –¥–ª—è Telegram-–±–æ—Ç–∞ SBS Helper.

## –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–¥—É–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –≥–¥–µ –∫–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è (–≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞—è–≤–æ–∫, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ —Ç.–¥.) —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–∞–∫ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –º–æ–¥—É–ª—å. –ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –∏–º–µ–µ—Ç —Å–≤–æ–∏:

- **messages.py** - –°–æ–æ–±—â–µ–Ω–∏—è –∏ —Ç–µ–∫—Å—Ç—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **settings.py** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥—É–ª—è –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
- **keyboards.py** - –ü–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä Telegram
- **\*_bot_part.py** - –û—Å–Ω–æ–≤–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –±–æ—Ç–∞ –∏ –ª–æ–≥–∏–∫–∞

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

```
src/sbs_helper_telegram_bot/
‚îú‚îÄ‚îÄ base_module.py          # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
‚îú‚îÄ‚îÄ telegram_bot/           # –û—Å–Ω–æ–≤–Ω–∞—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –±–æ—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ telegram_bot.py     # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—Å–µ –º–æ–¥—É–ª–∏
‚îú‚îÄ‚îÄ ticket_validator/       # –ü—Ä–∏–º–µ—Ä –º–æ–¥—É–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ messages.py         # –°–æ–æ–±—â–µ–Ω–∏—è –º–æ–¥—É–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ settings.py         # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥—É–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ keyboards.py        # –ü–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä
‚îÇ   ‚îú‚îÄ‚îÄ ticket_validator_bot_part.py  # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –±–æ—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ ...                 # –î—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã –º–æ–¥—É–ª—è
‚îî‚îÄ‚îÄ your_module/            # –í–∞—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –º–æ–¥—É–ª—å
    ‚îú‚îÄ‚îÄ __init__.py
    ‚îú‚îÄ‚îÄ messages.py
    ‚îú‚îÄ‚îÄ settings.py
    ‚îú‚îÄ‚îÄ keyboards.py
    ‚îî‚îÄ‚îÄ your_module_bot_part.py
```

## –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –º–æ–¥—É–ª—è

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –º–æ–¥—É–ª—è

–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ `src/sbs_helper_telegram_bot/`:

```bash
mkdir src/sbs_helper_telegram_bot/my_module
touch src/sbs_helper_telegram_bot/my_module/__init__.py
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ messages.py

–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –≤–∞—à–µ–≥–æ –º–æ–¥—É–ª—è:

```python
"""
–°–æ–æ–±—â–µ–Ω–∏—è –º–æ–¥—É–ª—è

–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –º–æ–µ–≥–æ –º–æ–¥—É–ª—è.
–°–æ–æ–±—â–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ñ–æ—Ä–º–∞—Ç Telegram MarkdownV2 –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
"""

# –û—Å–Ω–æ–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
MESSAGE_SUBMENU = "üîß *–ú–æ–π –º–æ–¥—É–ª—å*\n\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:"

MESSAGE_HELP = """*–°–ø—Ä–∞–≤–∫–∞ –ø–æ –º–æ–¥—É–ª—é*

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å –¥–µ–ª–∞–µ—Ç —á—Ç–æ\\-—Ç–æ –ø–æ–ª–µ–∑–Ω–æ–µ\\.

*–ö–æ–º–∞–Ω–¥—ã:*
‚Ä¢ `/mycommand` \\- —Å–¥–µ–ª–∞—Ç—å —á—Ç–æ\\-—Ç–æ"""

MESSAGE_SUCCESS = "‚úÖ –û–ø–µ—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞\\!"

MESSAGE_ERROR = "‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞\\. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞\\, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞\\."
```

### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ settings.py

–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –º–æ–¥—É–ª—è:

```python
"""
–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥—É–ª—è

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º–æ–¥—É–ª—è.
"""

from typing import Final, List

# –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª—è
MODULE_NAME: Final[str] = "–ú–æ–π –º–æ–¥—É–ª—å"
MODULE_DESCRIPTION: Final[str] = "–î–µ–ª–∞–µ—Ç —á—Ç–æ-—Ç–æ –ø–æ–ª–µ–∑–Ω–æ–µ"
MODULE_VERSION: Final[str] = "1.0.0"
MODULE_AUTHOR: Final[str] = "–í–∞—à–µ –∏–º—è"

# –ö–Ω–æ–ø–∫–∞ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é –¥–ª—è —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—è
MENU_BUTTON_TEXT: Final[str] = "üîß –ú–æ–π –º–æ–¥—É–ª—å"

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫ –ø–æ–¥–º–µ–Ω—é
SUBMENU_BUTTONS: Final[List[List[str]]] = [
    ["üìã –î–µ–π—Å—Ç–≤–∏–µ 1", "üìú –î–µ–π—Å—Ç–≤–∏–µ 2"],
    ["‚ÑπÔ∏è –°–ø—Ä–∞–≤–∫–∞"],
    ["üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"]
]

# –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥—É–ª—è
MY_SETTING: Final[int] = 100
ANOTHER_SETTING: Final[str] = "–∑–Ω–∞—á–µ–Ω–∏–µ"
```

### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ keyboards.py

–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –ø–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä:

```python
"""
–ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã –º–æ–¥—É–ª—è

–ü–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä Telegram –¥–ª—è –º–æ–¥—É–ª—è.
"""

from telegram import ReplyKeyboardMarkup
from . import settings


def get_submenu_keyboard() -> ReplyKeyboardMarkup:
    """
    –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –ø–æ–¥–º–µ–Ω—é –º–æ–¥—É–ª—è.
    
    Returns:
        ReplyKeyboardMarkup –¥–ª—è –ø–æ–¥–º–µ–Ω—é –º–æ–¥—É–ª—è
    """
    return ReplyKeyboardMarkup(
        settings.SUBMENU_BUTTONS,
        resize_keyboard=True,
        one_time_keyboard=False
    )
```

### –®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Å—Ç–∏ –±–æ—Ç–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:

```python
"""
–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –±–æ—Ç–∞ –º–æ–¥—É–ª—è

–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ Telegram –±–æ—Ç–∞ –¥–ª—è –º–æ–¥—É–ª—è.
"""

from telegram import Update, constants
from telegram.ext import ContextTypes, ConversationHandler
import logging

from src.common.telegram_user import check_if_user_legit, update_user_info_from_telegram
from src.common.messages import MESSAGE_PLEASE_ENTER_INVITE

# –ò–º–ø–æ—Ä—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –º–æ–¥—É–ª—è
from . import messages
from . import settings
from .keyboards import get_submenu_keyboard

logger = logging.getLogger(__name__)

# –°–æ—Å—Ç–æ—è–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞ (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
WAITING_FOR_INPUT = 1


async def my_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """
    –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã /mycommand.
    """
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    if not check_if_user_legit(update.effective_user.id):
        await update.message.reply_text(MESSAGE_PLEASE_ENTER_INVITE)
        return
    
    update_user_info_from_telegram(update.effective_user)
    
    # –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –∑–¥–µ—Å—å
    await update.message.reply_text(
        messages.MESSAGE_SUBMENU,
        parse_mode=constants.ParseMode.MARKDOWN_V2,
        reply_markup=get_submenu_keyboard()
    )


async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É –ø–æ –º–æ–¥—É–ª—é."""
    await update.message.reply_text(
        messages.MESSAGE_HELP,
        parse_mode=constants.ParseMode.MARKDOWN_V2
    )
```

### –®–∞–≥ 6: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–æ–¥—É–ª—è –≤ –≥–ª–∞–≤–Ω–æ–º –±–æ—Ç–µ

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `src/sbs_helper_telegram_bot/telegram_bot/telegram_bot.py`:

```python
# –î–æ–±–∞–≤—å—Ç–µ –∏–º–ø–æ—Ä—Ç—ã
from src.sbs_helper_telegram_bot.my_module import messages as my_messages
from src.sbs_helper_telegram_bot.my_module import keyboards as my_keyboards
from src.sbs_helper_telegram_bot.my_module.my_module_bot_part import (
    my_command,
    help_command as my_help_command,
)

# –î–æ–±–∞–≤—å—Ç–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤ main()
application.add_handler(CommandHandler("mycommand", my_command))

# –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é –≤ text_entered()
elif text == "üîß –ú–æ–π –º–æ–¥—É–ª—å":
    await update.message.reply_text(
        my_messages.MESSAGE_SUBMENU,
        parse_mode=constants.ParseMode.MARKDOWN_V2,
        reply_markup=my_keyboards.get_submenu_keyboard()
    )
```


## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –î–µ—Ä–∂–∏—Ç–µ –º–æ–¥—É–ª–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏

- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –∏–∑ `src.common.*` –¥–ª—è –æ–±—â–∏—Ö —É—Ç–∏–ª–∏—Ç
- –•—Ä–∞–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è –º–æ–¥—É–ª—è, –≤ —Ñ–∞–π–ª–∞—Ö –º–æ–¥—É–ª—è
- –ù–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∏–∑ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π, –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ

### 2. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ MarkdownV2 –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤: `_*[]()~\`>#+-=|{}.!`
- –•—Ä–∞–Ω–∏—Ç–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ `messages.py`
- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:

```python
def escape_md(text: str) -> str:
    """–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –¥–ª—è MarkdownV2."""
    special = ['_', '*', '[', ']', '(', ')', '~', '`', '>', '#', '+', '-', '=', '|', '{', '}', '.', '!']
    for char in special:
        text = str(text).replace(char, f'\\{char}')
    return text
```

### 3. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```python
if not check_if_user_legit(update.effective_user.id):
    await update.message.reply_text(MESSAGE_PLEASE_ENTER_INVITE)
    return
```

### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–û–±–æ—Ä–∞—á–∏–≤–∞–π—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∏ –≤–Ω–µ—à–Ω–∏–µ –≤—ã–∑–æ–≤—ã:

```python
try:
    result = do_something()
except Exception as e:
    logger.error(f"–û—à–∏–±–∫–∞: {e}", exc_info=True)
    await update.message.reply_text(
        messages.MESSAGE_ERROR,
        parse_mode=constants.ParseMode.MARKDOWN_V2
    )
```

### 5. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–≥–≥–µ—Ä, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –¥–ª—è –º–æ–¥—É–ª—è:

```python
import logging
logger = logging.getLogger(__name__)

logger.info("–û–ø–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞")
logger.error("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞", exc_info=True)
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞ –º–æ–¥—É–ª—è

–î–ª—è –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –º–æ–¥—É–ª–µ–π –Ω–∞—Å–ª–µ–¥—É–π—Ç–µ—Å—å –æ—Ç `BotModule`:

```python
from src.sbs_helper_telegram_bot.base_module import BotModule
from telegram import Update, ReplyKeyboardMarkup
from telegram.ext import BaseHandler, CommandHandler, ContextTypes
from typing import List, Optional, Dict

from . import messages
from . import settings
from .keyboards import get_submenu_keyboard


class MyModule(BotModule):
    
    @property
    def name(self) -> str:
        return settings.MODULE_NAME
    
    @property
    def description(self) -> str:
        return settings.MODULE_DESCRIPTION
    
    @property
    def version(self) -> str:
        return settings.MODULE_VERSION
    
    def get_handlers(self) -> List[BaseHandler]:
        return [
            CommandHandler("mycommand", self.handle_command),
        ]
    
    def get_menu_button(self) -> Optional[str]:
        return settings.MENU_BUTTON_TEXT
    
    async def handle_menu_button(self, update: Update, context: ContextTypes.DEFAULT_TYPE) -> bool:
        if update.message.text == settings.MENU_BUTTON_TEXT:
            await update.message.reply_text(
                messages.MESSAGE_SUBMENU,
                reply_markup=get_submenu_keyboard()
            )
            return True
        return False
    
    def get_commands(self) -> Dict[str, str]:
        return {
            "mycommand": "–ö–æ–º–∞–Ω–¥–∞ –º–æ–µ–≥–æ –º–æ–¥—É–ª—è"
        }
    
    def get_submenu_keyboard(self, user_id: int) -> Optional[ReplyKeyboardMarkup]:
        return get_submenu_keyboard()
    
    async def handle_command(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
        pass
```

## –î–æ—Å—Ç—É–ø –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ –≤–∞—à–µ–º—É –º–æ–¥—É–ª—é –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

```python
from src.common.database import get_db_connection, get_cursor

def get_my_data(user_id: int) -> dict:
    with get_db_connection() as conn:
        with get_cursor(conn) as cursor:
            cursor.execute(
                "SELECT * FROM my_table WHERE user_id = %s",
                (user_id,)
            )
            return cursor.fetchone()
```

## –ü—Ä–∏–º–µ—Ä ConversationHandler

–î–ª—è –º–Ω–æ–≥–æ—à–∞–≥–æ–≤—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π:

```python
from telegram.ext import ConversationHandler, CommandHandler, MessageHandler, filters

STEP_ONE, STEP_TWO = range(2)

async def start_conversation(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    await update.message.reply_text("–í–≤–µ–¥–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å:")
    return STEP_ONE

async def handle_step_one(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    context.user_data['step_one'] = update.message.text
    await update.message.reply_text("–í–≤–µ–¥–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å –µ—â–µ:")
    return STEP_TWO

async def handle_step_two(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    await update.message.reply_text("–ì–æ—Ç–æ–≤–æ!")
    return ConversationHandler.END

async def cancel(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    await update.message.reply_text("–û—Ç–º–µ–Ω–µ–Ω–æ.")
    return ConversationHandler.END

def get_conversation_handler() -> ConversationHandler:
    return ConversationHandler(
        entry_points=[CommandHandler("myconvo", start_conversation)],
        states={
            STEP_ONE: [MessageHandler(filters.TEXT & ~filters.COMMAND, handle_step_one)],
            STEP_TWO: [MessageHandler(filters.TEXT & ~filters.COMMAND, handle_step_two)],
        },
        fallbacks=[CommandHandler("cancel", cancel)]
    )
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –º–æ–¥—É–ª—è

–°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `tests/`:

```python
# tests/test_my_module.py
import pytest
from src.sbs_helper_telegram_bot.my_module import messages, settings

def test_messages_defined():
    assert hasattr(messages, 'MESSAGE_SUBMENU')
    assert hasattr(messages, 'MESSAGE_HELP')

def test_settings_defined():
    assert settings.MODULE_NAME
    assert settings.MODULE_VERSION
```

## –ß–µ–∫-–ª–∏—Å—Ç –º–æ–¥—É–ª—è

–ü–µ—Ä–µ–¥ –≤—ã–ø—É—Å–∫–æ–º –≤–∞—à–µ–≥–æ –º–æ–¥—É–ª—è:

- [ ] –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ `messages.py`
- [ ] –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `settings.py`
- [ ] –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã –≤ `keyboards.py`
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ù–∞–ø–∏—Å–∞–Ω—ã —Ç–µ—Å—Ç—ã
- [ ] README –∏–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –º–æ–¥—É–ª—è
- [ ] –ú–æ–¥—É–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ –≥–ª–∞–≤–Ω–æ–º –±–æ—Ç–µ
